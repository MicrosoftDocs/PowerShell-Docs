### YamlMime:PowershellCmdlet
summary: |-
  Runs commands from the session history.
module: Microsoft.PowerShell.Core
notes: |-
  The session history is a list of the commands entered during the session. The session history
  represents the order of execution, the status, and the start and end times of the command. As you
  enter each command, PowerShell adds it to the history so that you can reuse it. For more information
  about the session history, see [about_History](About/about_History.md).

  You can also refer to `Invoke-History` by its built-in aliases, `r` and `ihy`. For more information,
  see [about_Aliases](About/about_Aliases.md).
inputs:
- name: <xref href="System.String" data-throw-if-not-resolved="False" />
  description: |-
    You can pipe a history **Id** to this cmdlet.
outputs:
- name: <xref href="None" data-throw-if-not-resolved="False" />
  description: |-
    This cmdlet does not generate any output, but output might be generated by the commands that
    `Invoke-History` runs.
links:
- text: Add-History
  href: Add-History.yml
- text: Clear-History
  href: Clear-History.yml
- text: Get-History
  href: Get-History.yml
syntaxes:
- Invoke-History [[-Id] <String>] [-WhatIf] [-Confirm] [<CommonParameters>]
examples:
- title: 'Example 1: Run the most recent command in the history'
  code: |-
    Invoke-History
  description: ""
  summary: |+
    This example runs the last, or most recent, command in the session history. You can abbreviate this
    command as `r`, the alias for `Invoke-History`.

- title: 'Example 2: Run the command that has a specified ID'
  code: |-
    Invoke-History -Id 132
  description: ""
  summary: |+
    This example runs the command in the session history with **Id** 132. Because the name of the **Id**
    parameter is optional, you can abbreviate this command as the following: `Invoke-History 132`,
    `ihy 132`, or `r 132`.

- title: 'Example 3: Run the most recent command by using the command text'
  code: |-
    Invoke-History -Id get-pr
  description: |-
    > [!NOTE]
    > Pattern matching is case-insensitive, but the pattern matches the beginning of the line.
  summary: |+
    This example runs the most recent `Get-Process` command in the session history. When you type
    characters for the **Id** parameter, `Invoke-History` runs the first command that it finds that
    matches the pattern, starting with the most recent commands.

- title: 'Example 4: Run a sequence of commands from the history'
  code: |-
    16..24 | ForEach {Invoke-History -Id $_ }
  description: ""
  summary: |+
    This example runs commands 16 through 24. Because you can list only one **Id** value, the command
    uses the `ForEach-Object` cmdlet to run the `Invoke-History` command one time for each **Id** value.

- title: Example 5
  code: |-
    Get-History -Id 255 -Count 7 | ForEach {Invoke-History -Id $_.Id}
  description: ""
  summary: |+
    This example runs the seven commands in the history that end with command 255 (249 through 255). It
    uses the `Get-History` cmdlet to retrieve the commands. Because you can list only one **Id** value,
    the command uses the `ForEach-Object` cmdlet to run the `Invoke-History` command once for each
    **Id** value.

parameters:
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: "False"
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="System.String" data-throw-if-not-resolved="False" />
  name: Id
  description: |+
    Specifies the **Id** of a command in the history. You can type the **Id** number of the command or
    the first few characters of the command.

    If you type characters, `Invoke-History` matches the most recent commands first. If you omit this
    parameter, `Invoke-History` runs the last, or most recent, command. To find the **Id** number of a
    command, use the `Get-History` cmdlet.

  defaultValue: None
  pipelineInput: true
  position: "0"
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="System.Management.Automation.SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs. The cmdlet is not run.

  defaultValue: "False"
  position: Named
  aliases: wi
  parameterValueGroup: ""
uid: Microsoft.PowerShell.Core.Invoke-History
name: Invoke-History
description: |-
  The `Invoke-History` cmdlet runs commands from the session history. You can pass objects
  representing the commands from Get-History to `Invoke-History`, or you can identify commands in the
  current history by using their **Id** number. To find the identification number of a command, use
  the `Get-History` cmdlet.

  The session history is managed separately from the history maintained by the **PSReadLine** module.
  Both histories are available in sessions where **PSReadLine** is loaded. This cmdlet only works with
  the session history. For more information see, [about_PSReadLine](../PSReadLine/About/about_PSReadLine.md).
metadata:
  external help file: System.Management.Automation.dll-Help.xml
  keywords: powershell,cmdlet
  Locale: en-US
  Module Name: Microsoft.PowerShell.Core
  ms.date: 05/13/2020
  online version: https://docs.microsoft.com/powershell/module/microsoft.powershell.core/invoke-history?view=powershell-5.1&WT.mc_id=ps-gethelp
  schema: 2.0.0
  title: Invoke-History
